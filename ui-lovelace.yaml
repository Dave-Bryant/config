resources:
  - type: module
    url: /hacsfiles/canvas-gauge-card/canvas-gauge-card.js
  - type: module
    url: /hacsfiles/lovelace-card-templater/lovelace-card-templater.js
  - type: module
    url: /hacsfiles/lovelace-multiple-entity-row/multiple-entity-row.js
  - type: module
    url: /hacsfiles/button-card/button-card.js
  - type: module
    url: /hacsfiles/history-explorer-card/history-explorer-card.js
  - type: module
    url: /hacsfiles/bom-radar-card/bom-radar-card.js
  - type: module
    url: /hacsfiles/hass-swipe-navigation/swipe-navigation.js
  - type: module
    url: /hacsfiles/uptime-card/uptime-card.js
  - type: module
    url: /hacsfiles/apexcharts-card/apexcharts-card.js?v=2.0.1
  - type: module
    url: /hacsfiles/vacuum-card/vacuum-card.js
  - type: module
    url: /hacsfiles/mini-climate-card/mini-climate-card-bundle.js?v=2.21


no-top-header:
  card-mod-theme: no-top-header
  card-mod-root: |
    app-toolbar {
      display: none;
    }

swipe_nav:
  wrap: true
  animate: swipe
  prevent_default: true
  swipe_amount: 15

views:
  - title: Home
    background: var(--background-image)
    badges:
      - entity: binary_sensor.home_assistant_versions_update_available
        name: Update?
      - entity: person.david_bryant
      - entity: person.wendy_bryant
      - entity: group.bryant_family
      - entity: sun.sun  
      - entity: binary_sensor.motion_sensor_4_porch_occupancy   
         


    cards:

      - type: vertical-stack
        cards:
        - type: horizontal-stack
          cards:
            - type: 'custom:button-card'
              entity: light.osram_light_family_room
              name: Family Room
              icon: 'mdi:lightbulb'
              aspect_ratio: 1.5/1
              color: auto
              state:
                - value: 'on'
                  color: rgb(255, 255, 0)
              label: |
                [[[
                    var bri = (states['light.osram_light_family_room'].attributes.brightness / 254 * 100).toFixed(0);
                    if (isNaN(bri))
                      return 'Brightness: ' + '0' + '%';
                    else
                      return 'Brightness: ' + (bri ? bri : '0') + '%';
                ]]]
              show_label: true
              size: 30%
              styles:
                card:
                  - height: 60px
                  - font-size: 12px
            - type: 'custom:button-card'
              entity: light.osram_light_holly
              name: Hollys Bedroom
              icon: 'mdi:lightbulb'
              aspect_ratio: 1.5/1
              color: auto
              state:
                - value: 'on'
                  color: rgb(255, 255, 0)
              label: |
                [[[
                    var bri = (states['light.osram_light_holly'].attributes.brightness / 254 * 100).toFixed(0);
                    if (isNaN(bri))
                      return 'Brightness: ' + '0' + '%';
                    else
                      return 'Brightness: ' + (bri ? bri : '0') + '%';
                ]]]
              show_label: true
              size: 30%
              styles:
                card:
                  - height: 60px
                  - font-size: 12px
            - type: 'custom:button-card'
              entity: light.osram_light_spare_bedroom
              name: Spare Bedroom
              icon: 'mdi:lightbulb'
              aspect_ratio: 1.5/1
              color: auto
              state:
                - value: 'on'
                  color: rgb(255, 255, 0)
              label: |
                [[[
                    var bri = (states['light.osram_light_spare_bedroom'].attributes.brightness / 254 * 100).toFixed(0);
                    if (isNaN(bri))
                      return 'Brightness: ' + '0' + '%';
                    else
                      return 'Brightness: ' + (bri ? bri : '0') + '%';
                ]]]
              show_label: true
              size: 30%
              styles:
                card:
                  - height: 60px
                  - font-size: 12px
        - type: horizontal-stack
          cards:              
            - type: 'custom:button-card'
              entity: switch.upstairs_light
              name: Upstairs Lamp
              icon: 'mdi:lightbulb'
              aspect_ratio: 1.5/1
              color: auto
              state:
                - value: 'on'
                  color: rgb(255, 255, 0)
              show_label: true
              size: 30%
              styles:
                card:
                  - height: 60px
                  - font-size: 12px
            - type: 'custom:button-card'
              entity: switch.spare_switch
              name: Lounge Room
              icon: 'mdi:lightbulb'
              aspect_ratio: 1.5/1
              color: auto
              state:
                - value: 'on'
                  color: rgb(255, 255, 0)              
              show_label: true
              size: 30%
              styles:
                card:
                  - height: 60px
                  - font-size: 12px
                  

            - type: 'custom:button-card'
              entity: switch.light_switch_garage
              name: Garage Light
              icon: 'mdi:lightbulb'
              aspect_ratio: 1.5/1
              color: auto
              state:
                - value: 'on'
                  color: rgb(255, 255, 0)              
              show_label: true
              size: 30%
              styles:
                card:
                  - height: 60px
                  - font-size: 12px

                  
        - type: horizontal-stack
          cards:
            - type: 'custom:button-card'
              entity: switch.spare_2
              name: EV Charging
              icon: 'mdi:power'
              aspect_ratio: 1.5/1
              color: auto
              state:
                - value: 'on'
                  color: rgb(255, 255, 0)
              label: >
                [[[
                  var cost = states['sensor.ev_charge_cost'].state;
                  if (isNaN(cost))
                    return 'Cost $: ' + '9';
                  else
                    return 'Cost $: ' + (cost ? cost : '0');
                ]]]               
              show_label: true
              size: 30%
              styles:
                card:
                  - height: 60px
                  - font-size: 12px
            - type: 'custom:button-card'
              entity: input_boolean.check_odometer
              name: Odometer
              icon: 'mdi:power'
              aspect_ratio: 1.5/1
              color: auto
              state:
                - value: 'on'
                  color: rgb(255, 255, 0)
              label: >
                [[[
                  var dist = states['sensor.ayaf94h_odometer'].state;
                  if (isNaN(dist))
                    return 'Dist: ' + '0';
                  else
                    return 'Dist: ' + (dist ? dist : '0');
                ]]]               
              show_label: true
              size: 30%
              styles:
                card:
                  - height: 60px
                  - font-size: 12px

      - type: entities
        entities:
          - media_player.samsung_q80_series_65
        title: Television
      
      - type: media-control
        entity: media_player.study



      - type: horizontal-stack
        title: Local
        cards:
          - type: custom:canvas-gauge-card
            entity: sensor.processor_temperature
            card_height: 62
            gauge:
              type: "radial-gauge"
              title: CPU Temperature
              width: 110
              height: 110
              borderShadowWidth: 0
              borderOuterWidth: 0
              borderMiddleWidth: 0
              borderInnerWidth: 0
              minValue: 0
              maxValue: 100
              startAngle: 90
              ticksAngle: 180
              valueBox: false
              majorTicks:
                ["0", "10", "20", "30", "40", "50", "60", "70", "80", "90", "100"]
              minorTicks: 2
              strokeTicks: true
              highlights:
                [{ "from": 70, "to": 100, "color": "rgba(200, 50, 50, .75)" }]
              colorPlate: "#ddd"
              borders: false
              needleType: "arrow"
              needleWidth: 2
              needleCircleSize: 7
              needleCircleOuter: true
              needleCircleInner: false
              animationDuration: 1500
              animationRule: "linear"
          - type: custom:canvas-gauge-card
            entity: sensor.memory_use_percent
            card_height: 62
            gauge:
              type: "radial-gauge"
              title: Memory Usage (%)
              width: 110
              height: 110
              borderShadowWidth: 0
              borderOuterWidth: 0
              borderMiddleWidth: 0
              borderInnerWidth: 0
              minValue: 0
              maxValue: 100
              startAngle: 90
              ticksAngle: 180
              valueBox: false
              majorTicks:
                ["0", "10", "20", "30", "40", "50", "60", "70", "80", "90", "100"]
              minorTicks: 2
              strokeTicks: true
              highlights:
                [{ "from": 80, "to": 100, "color": "rgba(200, 50, 50, .75)" }]
              colorPlate: "#ddd"
              borders: false
              needleType: "arrow"
              needleWidth: 2
              needleCircleSize: 7
              needleCircleOuter: true
              needleCircleInner: false
              animationDuration: 1500
              animationRule: "linear"
          - type: custom:canvas-gauge-card
            entity: sensor.processor_use
            card_height: 62
            gauge:
              type: "radial-gauge"
              title: Processor Usage (%)
              width: 110
              height: 110
              borderShadowWidth: 0
              borderOuterWidth: 0
              borderMiddleWidth: 0
              borderInnerWidth: 0
              minValue: 0
              maxValue: 100
              startAngle: 90
              ticksAngle: 180
              valueBox: false
              majorTicks:
                ["0", "10", "20", "30", "40", "50", "60", "70", "80", "90", "100"]
              minorTicks: 2
              strokeTicks: true
              highlights:
                [{ "from": 80, "to": 100, "color": "rgba(200, 50, 50, .75)" }]
              colorPlate: "#ddd"
              borders: false
              needleType: "arrow"
              needleWidth: 2
              needleCircleSize: 7
              needleCircleOuter: true
              needleCircleInner: false
              animationDuration: 1500
              animationRule: "linear"

      - type: horizontal-stack
        title: Remote
        cards:
          - type: custom:canvas-gauge-card
            entity: sensor.garage_pi_sensors_garage_pi_temperature
            card_height: 62
            gauge:
              type: "radial-gauge"
              title: CPU Temperature
              width: 110
              height: 110
              borderShadowWidth: 0
              borderOuterWidth: 0
              borderMiddleWidth: 0
              borderInnerWidth: 0
              minValue: 0
              maxValue: 100
              startAngle: 90
              ticksAngle: 180
              valueBox: false
              majorTicks:
                ["0", "10", "20", "30", "40", "50", "60", "70", "80", "90", "100"]
              minorTicks: 2
              strokeTicks: true
              highlights:
                [{ "from": 70, "to": 100, "color": "rgba(200, 50, 50, .75)" }]
              colorPlate: "#ddd"
              borders: false
              needleType: "arrow"
              needleWidth: 2
              needleCircleSize: 7
              needleCircleOuter: true
              needleCircleInner: false
              animationDuration: 1500
              animationRule: "linear"
          - type: custom:canvas-gauge-card
            entity: sensor.garage_pi_sensors_garage_pi_memory_use
            card_height: 62
            gauge:
              type: "radial-gauge"
              title: Memory Usage (%)
              width: 110
              height: 110
              borderShadowWidth: 0
              borderOuterWidth: 0
              borderMiddleWidth: 0
              borderInnerWidth: 0
              minValue: 0
              maxValue: 100
              startAngle: 90
              ticksAngle: 180
              valueBox: false
              majorTicks:
                ["0", "10", "20", "30", "40", "50", "60", "70", "80", "90", "100"]
              minorTicks: 2
              strokeTicks: true
              highlights:
                [{ "from": 80, "to": 100, "color": "rgba(200, 50, 50, .75)" }]
              colorPlate: "#ddd"
              borders: false
              needleType: "arrow"
              needleWidth: 2
              needleCircleSize: 7
              needleCircleOuter: true
              needleCircleInner: false
              animationDuration: 1500
              animationRule: "linear"
          - type: custom:canvas-gauge-card
            entity: sensor.garage_pi_sensors_garage_pi_cpu_usage
            card_height: 62
            gauge:
              type: "radial-gauge"
              title: Processor Usage (%)
              width: 110
              height: 110
              borderShadowWidth: 0
              borderOuterWidth: 0
              borderMiddleWidth: 0
              borderInnerWidth: 0
              minValue: 0
              maxValue: 100
              startAngle: 90
              ticksAngle: 180
              valueBox: false
              majorTicks:
                ["0", "10", "20", "30", "40", "50", "60", "70", "80", "90", "100"]
              minorTicks: 2
              strokeTicks: true
              highlights:
                [{ "from": 80, "to": 100, "color": "rgba(200, 50, 50, .75)" }]
              colorPlate: "#ddd"
              borders: false
              needleType: "arrow"
              needleWidth: 2
              needleCircleSize: 7
              needleCircleOuter: true
              needleCircleInner: false
              animationDuration: 1500
              animationRule: "linear"

      - type: custom:mini-climate
        entity: climate.study
        toggle: hide
        indicators:
          humidity:
            icon: mdi:water
            unit: '%'
            round: 1
            source:
              entity: sensor.study_humidity

      # - entity: climate.study
      #   sensors:
      #     - entity: sensor.study_humidity
      #       name: Humidity
      #   type: 'custom:simple-thermostat'
      - type: custom:mini-climate
        entity: climate.hollys_bedroom
        toggle: hide
        indicators:
          humidity:
            icon: mdi:water
            unit: '%'
            round: 1
            source:
              entity: sensor.hollys_bedroom_humidity
      # - entity: climate.hollys_bedroom
      #   sensors:
      #     - entity: sensor.hollys_bedroom_humidity
      #       name: Humidity
      #   type: 'custom:simple-thermostat'
      - type: custom:mini-climate
        entity: climate.wendys_bedroom
        toggle: hide
        indicators:
          humidity:
            icon: mdi:water
            unit: '%'
            round: 1
            source:
              entity: sensor.wendys_bedroom_humidity
      # - entity: climate.wendys_bedroom
      #   sensors:
      #     - entity: sensor.wendys_bedroom_humidity
      #       name: Humidity
      #   type: 'custom:simple-thermostat'
      - type: custom:mini-climate
        entity: climate.family_room
        toggle: hide
        indicators:
          humidity:
            icon: mdi:water
            unit: '%'
            round: 1
            source:
              entity: sensor.family_room_humidity
      # - entity: climate.family_room
      #   sensors:
      #     - entity: sensor.family_room_humidity
      #       name: Humidity
      #   type: 'custom:simple-thermostat'
      - entities:
          - entity: sensor.speedtest_download
          - entity: sensor.speedtest_upload
          - entity: sensor.speedtest_ping
        show_header_toggle: false
        title: Network
        type: entities
      - type: entities
        entities:
          - sensor.auto_backup
        title: Snapshot
      - type: entities
        entities:
          - sensor.hp_officejet_pro_9020_series
          - sensor.hp_officejet_pro_9020_series_black_cartridge
          - sensor.hp_officejet_pro_9020_series_cyan_cartridge
          - sensor.hp_officejet_pro_9020_series_magenta_cartridge
          - sensor.hp_officejet_pro_9020_series_yellow_cartridge
        state_color: true
        title: Printer Status
      - type: entities
        entities:
          - sensor.act_garbage_last_updated
          - sensor.act_garbage_pickup
          - sensor.act_recycling_pickup
          - sensor.act_greenwaste_pickup
          - input_boolean.check_act_garbage
          - binary_sensor.act_garbage_today
          - binary_sensor.act_garbage_tomorrow
          - binary_sensor.act_recycling_today
          - binary_sensor.act_recycling_tomorrow
          - binary_sensor.act_greenwaste_today
          - binary_sensor.act_greenwaste_tomorrow
        title: ACT Garbage Collection
        show_header_toggle: false
  - title: Ecovac
    cards:
      - type: custom:vacuum-card
        entity: vacuum.daves_deebot_n8
        image: default
        compact_view: false
        show_name: true
        show_toolbar: true
        show_status: true 
        stats:
          default:
            - entity_id: sensor.daves_deebot_n8_life_span_brush
              subtitle: Main brush
              unit: '%'              
            - entity_id: sensor.daves_deebot_n8_life_span_side_brush              
              unit: '%'
              subtitle: Side brush
            - entity_id: sensor.daves_deebot_n8_life_span_brush
              unit: '%'
              subtitle: Filter 
        my-custom-theme:
          - vc-background: '#17A8F4'
            vc-spacing: 5px 
        shortcuts:          
          - name: Clean bedroom
            service: script.clean_bedroom
            icon: 'mdi:bed-empty'       
        map: camera.daves_deebot_n8_live_map
        
      - type: grid
        square: false
        columns: 1
        cards:
          - type: entities
            entities:
              - entity: sensor.daves_deebot_n8_last_cleaning
                name: Last cleaning
              - type: section
              - entity: sensor.daves_deebot_n8_stats_area
                name: Stats area
              - entity: sensor.daves_deebot_n8_stats_time
                name: Stats time
              - entity: sensor.daves_deebot_n8_stats_total_area
                name: Stats total area
              - entity: sensor.daves_deebot_n8_stats_total_cleanings
                name: Stats total cleanings
              - entity: sensor.daves_deebot_n8_stats_total_time
                name: Stats total time              
              - entity: number.daves_deebot_n8_clean_count
                name: Clean count
            title: Deebot N8 Stats
      - type: grid
        square: false        
        columns: 1
        cards:
          - type: entities
            show_header_toggle: false
            entities:
              - entity: switch.daves_deebot_n8_advanced_mode
                name: Advanced mode
              - entity: switch.daves_deebot_n8_carpet_auto_fan_speed_boost
                name: Carpet auto fan speed boost
              - entity: switch.daves_deebot_n8_clean_preference
                name: Clean preference
              - entity: switch.daves_deebot_n8_continuous_cleaning
                name: Continuous cleaning
              - entity: switch.daves_deebot_n8_true_detect
                name: True detect
              - entity: number.daves_deebot_n8_volume
                name: Volume
              - entity: button.daves_deebot_n8_life_span_filter_reset
                name: Life span filter reset
              - entity: button.daves_deebot_n8_life_span_side_brush_reset
                name: Life span side brush reset 
              - entity: select.daves_deebot_n8_water_amount
                name: Water amount 
              - entity: button.daves_deebot_n8_life_span_brush_reset
                name: Life span brush reset  
            title: Deebot N8 Configuration    

  - title: Energy & Helium
    cards:        
      - type: custom:apexcharts-card
        graph_span: 7d
        # span:
        #   start: day
        #   offset: +18h
        header:
          title: 'Energy for EV (AUD)'
          show: true
        series:
         # data from today
          - entity: sensor.ev_charge_cost
            fill_raw: 'last'
            group_by:
              duration: 24h
              func: max
      # - type: iframe          
      #   url: http://10.0.0.55:3000/api/hassio_ingress/3eZf1RWXgPHubUsGs2TsNUMhnzzV1lmAy0YAEJH4tS8/d-solo/E-rczO-4z/ev-charging?orgId=1&from=1677898376335&to=1678503176336&panelId=6&kiosk
      #   aspect_ratio: 100%
  # - title: Helium
  #   cards:      
      # - type: custom:apexcharts-card
      #   header:
      #     show: true
      #     title: Helium AUD
      #     show_states: true
      #     colorize_states: true
      #   series:
      #     - entity: sensor.helium_wallet_value
      #       color: green
      #       type: line
      #       stroke_width: 4
      #       fill_raw: 'last'
      #       extend_to: false
      #       group_by:
      #         duration: 24h
      #         func: max
      #   graph_span: 7d
      #   span:
      #     end: day
      # - type: custom:apexcharts-card
      #   header:
      #     title: '24 hr Growth in Wallet (AUD)'
      #     show: true
      #   series:
      #    # data from today
      #     - entity: sensor.helium_wallet_value
      #       fill_raw: 'last'
      #       group_by:
      #         duration: 24h
      #         func: max
      #    # data from yesterday offsetted to be displayed today
      #     - entity: sensor.helium_wallet_value
      #       fill_raw: 'last'
      #       group_by:
      #         duration: 24h
      #         func: max
      #       offset: -1d
      #   graph_span: 7d
      #   span:
      #     end: day


      # - type: entities
      #   title: 'Helium Tokens balances'
      #   entities:
      #      - entity: sensor.helium_wallet_hvhi_hnt_balance
      #        name: HNT Account
      #      - entity: sensor.helium_wallet_hvhi_iot_balance
      #        name: IOT Account 
      #      - entity: sensor.helium_hotspot_reward_wallet_hvhi_unclaimed_rewards
      #        name: IOT Unclaimed               
      #      - entity: sensor.helium_wallet_hvhi_sol_balance
      #        name: SOL Account

      # - type: custom:apexcharts-card
      #   all_series_config:
      #     float_precision: 3
      #   apex_config:
      #     yaxis:
      #       - seriesName: HNT
      #         decimalsInFloat: 0
      #       - seriesName: Helium
      #         show: false
      #   experimental:
      #     color_threshold: true
      #   graph_span: 7d
      #   span:
      #     end: day
      #   show:
      #     last_updated: true
      #   header:
      #     show: true
      #     show_states: true
      #     colorize_states: true
      #     title: Total HNT per day
      #   series:
      #     - entity: sensor.helium_wallet_today
      #       show:
      #         header_color_threshold: true
      #         extremas: true
      #       type: column
      #       name: Today
      #       group_by:
      #         func: last
      #         duration: 1d
      #     - entity: sensor.helium_wallet_today
      #       name: Yesterday
      #       offset: '-1d'
      #       show:
      #         in_header: true
      #         in_chart: false

      - type: custom:apexcharts-card
        header:
          show: true
          title: Total Earnings ($A)
          show_states: true
          colorize_states: true
        all_series_config:
          stroke_width: 2
          extend_to: false
          type: 'line'          
        series:
          - entity: sensor.aus_wallet_total
          - entity: sensor.helium_wallet_value                     
          - entity: sensor.iot_wallet_value            
          - entity: sensor.iot_wallet_value_unclaimed                      
          - entity: sensor.sol_wallet_value                                
        graph_span: 30d
        span:
          end: day
      - type: custom:apexcharts-card
        header:
          show: true
          title: HotSpot Performance (IoT)
          show_states: true
          colorize_states: true
        all_series_config:
          stroke_width: 2
          extend_to: false
          type: 'line'          
        series:       
          - entity: sensor.helium_hotspot_reward_wallet_hvhi_unclaimed_rewards 
        graph_span: 7d
        span:
          end: day

      # - type: iframe
      #   #url: http://10.0.0.55:3000/api/hassio_ingress/3eZf1RWXgPHubUsGs2TsNUMhnzzV1lmAy0YAEJH4tS8/dashboard/snapshot/m5HMuP0mzTm8XqKLEHw2gebCRQe8wTgN?kiosk
      #   url: http://10.0.0.55:3000/api/hassio_ingress/3eZf1RWXgPHubUsGs2TsNUMhnzzV1lmAy0YAEJH4tS8/d/IJJKJGzVk/daves-dashboard?orgId=1&viewPanel=1&kiosk
      #   aspect_ratio: 85%
  
  
  - title: Irrigation
    cards:
      - type: entities
        title: 'Irrigation Status'
        entities:
          - entity: switch.irrigation_switch_1_l3  #Front Lawn West Irrigation
            icon: 'mdi:grass'
            type: custom:multiple-entity-row
            name: frlawnwest
            toggle: true
            state_color: true
            entities:
              - entity: input_text.irrigation_switch_1_l3_run_time
                name: run time
              - entity: input_text.irrigation_switch_1_l3_run_date
                name: run date
              - entity: input_text.irrigation_switch_1_l3_run_duration
                name: run dur.
                format: duration
          - entity: switch.irrigation_switch_1_l2  #Front Lawn East Irrigation
            icon: 'mdi:grass'
            type: custom:multiple-entity-row
            name: frlawneast
            toggle: true
            state_color: true
            entities:
              - entity: input_text.irrigation_switch_1_l2_run_time
                name: false
              - entity: input_text.irrigation_switch_1_l2_run_date
                name: false
              - entity: input_text.irrigation_switch_1_l2_run_duration
                name: false
                format: duration
          - entity: switch.irrigation_switch_1_l1  #Back Lawn South Irrigation
            icon: 'mdi:grass'
            type: custom:multiple-entity-row
            name: bklawnsouth
            toggle: true
            state_color: true
            entities:
              - entity: input_text.irrigation_switch_1_l1_run_time
                name: false
              - entity: input_text.irrigation_switch_1_l1_run_date
                name: false
              - entity: input_text.irrigation_switch_1_l1_run_duration
                name: false
                format: duration
          - entity: switch.irrigation_switch_1_l4  #Back Lawn North Irrigation
            icon: 'mdi:grass'
            type: custom:multiple-entity-row
            name: bklawnnorth
            toggle: true
            state_color: true
            entities:
              - entity: input_text.irrigation_switch_1_l4_run_time
                name: false
              - entity: input_text.irrigation_switch_1_l4_run_date
                name: false
              - entity: input_text.irrigation_switch_1_l4_run_duration
                name: false
                format: duration
          - type: section
          - entity: switch.irrigation_switch_2_l4  # Front Garden
            icon: 'mdi:water-pump'
            type: custom:multiple-entity-row
            name: frontgarden
            toggle: true
            state_color: true
            entities:
              - entity: input_text.irrigation_switch_2_l4_run_time
                name: false
              - entity: input_text.irrigation_switch_2_l4_run_date
                name: false
              - entity: input_text.irrigation_switch_2_l4_run_duration
                name: false
                format: duration
          - entity: switch.irrigation_switch_2_l3  # Back & Side Garden
            icon: 'mdi:water-pump'
            type: custom:multiple-entity-row
            name: backsidegarden
            toggle: true
            state_color: true
            entities:
              - entity: input_text.irrigation_switch_2_l3_run_time
                name: false
              - entity: input_text.irrigation_switch_2_l3_run_date
                name: false
              - entity: input_text.irrigation_switch_2_l3_run_duration
                name: false
                format: duration
          - entity: switch.irrigation_switch_2_l2
            icon: 'mdi:water-pump-off'
            type: custom:multiple-entity-row
            name: tinybacklawn
            toggle: true
            state_color: true
            entities:
              - entity: input_text.irrigation_switch_2_l2_run_time
                name: false
              - entity: input_text.irrigation_switch_2_l2_run_date
                name: false
              - entity: input_text.irrigation_switch_2_l2_run_duration
                name: false
                format: duration
          - type: section
          - entity: input_number.garden_watering_time
            #type: custom:multiple-entity-row
            #state_header: 'Garden'
            format: duration
            #entities:
          - entity: sensor.smart_irrigation_lawns
            name: Daily Adjusted Run Time
          #      attribute: adjusted_run_time_minutes
          #- entity: sensor.smart_irrigation_hourly_adjusted_run_time
              #  attribute: adjusted_run_time_minutes
          - entity: input_select.irrigation_status
            #name: false

      - type: entities
        title: 'Force Irrigation'
        entities:
          - entity: input_boolean.force_irrigation
            type: custom:multiple-entity-row
            name: Force irrigation
            state_header: 'Force'
            toggle: true
            format: duration
            entities:
              - attribute: force_mode_duration
                name: Force Mode Duration
                entity: sensor.smart_irrigation_daily_adjusted_run_time
  - title: Weather
    cards:
      - type: custom:apexcharts-card
        header:
          show: true
          title: Precipitation & Temperature
          show_states: true
          colorize_states: true
        series:
          - entity: sensor.dailyrain
            name: 'Precipitation' 
            color: blue
            type: line
            stroke_width: 2
            extend_to: false
            group_by:
              duration: 1d
              func: avg
          - entity: sensor.temp
            name: 'Temperature'
            color: red
            type: line
            stroke_width: 2
            extend_to: false
        graph_span: 28d
        span:
          end: day
      
          
          

      - type: 'custom:card-templater'
        card:
          type: entities
          title: Weather Overview
          entities:
            - entity: sensor.pws_forecast_narrative_today
              icon: 'mdi:weather-sunny'
              name_template: >-
                {{ states("sensor.pws_forecast_narrative_today") | truncate(8,true,' ')
                }}
            - entity: sensor.pws_forecast_narrative_tonight
              icon: 'mdi:weather-night'
              name_template: >-
                {{ states("sensor.pws_forecast_narrative_tonight") | truncate(10,true,'
                ')  }}
            - entity: sensor.pws_forecast_narrative_tomorrow
              icon: 'mdi:weather-sunny'
              name_template: >-
                {{ states("sensor.pws_forecast_narrative_tomorrow") | truncate(11,true,'
                ')  }}
            - entity: sensor.pws_forecast_narrative_tomorrow_tonight
              icon: 'mdi:weather-night'
              name_template: >-
                {{ states("sensor.pws_forecast_narrative_tomorrow_tonight") |
                truncate(20,true,' ') }}
        entities:
          - entity: sensor.pws_forecast_narrative_today
            state_template: >-
              {% set first_word =  states("sensor.pws_forecast_narrative_today") |  truncate(8,true,' ')%}
              {% if first_word | trim  == 'Waiting' %}
              {{ states("sensor.pws_forecast_narrative_today") | truncate(8,true,' ') | trim }}
              {%- else -%}
              {{states("sensor.pws_forecast_narrative_today") | regex_replace(find='Today', replace=' ', ignorecase=False) }}
              {% endif %}
          - entity: sensor.pws_forecast_narrative_tonight
            state_template: >-
              {{ states("sensor.pws_forecast_narrative_tonight") |
              regex_replace(find='Tonight', replace=' ', ignorecase=False)   }}
          - entity: sensor.pws_forecast_narrative_tomorrow
            state_template: >-
              {{ states("sensor.pws_forecast_narrative_tomorrow") |
              regex_replace(find='Tomorrow', replace=' ', ignorecase=False)  }}
          - entity: sensor.pws_forecast_narrative_tomorrow_tonight
            state_template: >-
              {{ states("sensor.pws_forecast_narrative_tomorrow_tonight") |
              regex_replace(find='Tomorrow night', replace=' ', ignorecase=False)  }}
        entity: sensor.pws_forecast_narrative_tonight

      - type: entities
        title: 'Canberra Dams'
        entities:
           - entity: input_boolean.check_dams
           - entity: sensor.act_dam_bendora_dam
           - entity: sensor.act_dam_corin_dam
           - entity: sensor.act_dam_cotter_dam
           - entity: sensor.act_dam_googong_dam
           - entity: sensor.act_dam_combined_volume
           - entity: sensor.act_dam_last_updated

      - type: entities
        title: 'Daily Forecast'
        entities:
          - entity: sensor.precip_chance_today # from REST PWS
            icon: 'mdi:weather-pouring'
          - entity: sensor.precip_chance_tomorrow # from REST PWS
            icon: 'mdi:weather-pouring'
          - entity: sensor.dailyrain # correct
            name: 'daily rain'
          - entity: sensor.eventrain
            name: 'rain event precipitation'
          - type: section
          - entity: sensor.temp # Correct
            name: 'outside temperature'
          - entity: sensor.feelslike
            name: 'outside temperature feels like'
          - entity: sensor.thermalperception
            name: 'perception of temperature'          
          - entity: sensor.high_temperature_today # from config then Ecowitt
            name: 'maximum temperature today'
          - entity: sensor.low_temperature_today
            name: 'minimum temperature today'
          - type: section
          - entity: sensor.safe_exposure_time_skin_type_2
            name: 'safe sun exposure time'
          - entity: sensor.uv
            name: 'UV index(>3 needs protection)'
          - entity: sensor.solarradiation # correct
            name: 'solar radiation'
          - type: section
          - entity: sensor.frostrisk
            name: 'risk of frost' 
          - entity: sensor.dewpoint # correct
            name: 'dew point'          
          - entity: sensor.windspeed  # correct          
            name: 'wind speed'
          - entity: sensor.humidity  # correct
            name: 'humidity'
          - entity: sensor.baromrel # correct
            name: 'relative air pressure'

      - type: 'custom:bom-radar-card'
        frame_count: 10
        center_latitude: -35.282000
        center_longitude: 149.1287
        show_marker: true
        show_range: true
        show_zoom: true
        show_recenter: true
        show_playback: true
        map_style: 'satellite'
        zoom_level: 8


  - title: Cameras
    cards:
      - type: picture-entity
        entity: camera.front_camera
        tap_action:
          action: call-service
          service: camera.snapshot
          service_data:
            entity_id: camera.front_camera
            filename: '/media/front_camera-{{ now().strftime("%Y-%m-%d-%H%M%S") }}.jpg'

      - type: picture-entity
        entity: camera.back_camera
        tap_action:
          action: call-service
          service: camera.snapshot
          service_data:
            entity_id: camera.back_camera
            filename: '/media/front_camera-{{ now().strftime("%Y-%m-%d-%H%M%S") }}.jpg'

  - title: History
    type: custom:history-explorer-card
    cardName: historycard-95223723
    recordedEntitiesOnly: true
    defaultTimeRange: 7d

  - title: Grafana
    cards:
      - type: iframe
        # url: http://10.0.0.55:3000/api/hassio_ingress/3eZf1RWXgPHubUsGs2TsNUMhnzzV1lmAy0YAEJH4tS8/dashboard/snapshot/GcoR4m6EiZ5E3Aoe5379EyjuY4H0eM6L?orgId=1&kiosk
        url: http://10.0.0.55:3000/api/hassio_ingress/3eZf1RWXgPHubUsGs2TsNUMhnzzV1lmAy0YAEJH4tS8/d/zzAVYzLnz/home-assistant?orgId=1&kiosk
        aspect_ratio: 100%

    path: default_view
